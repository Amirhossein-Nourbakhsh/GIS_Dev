#-------------------------------------------------------------------------------
# Name:        Extract_Footprint.py
# Purpose:     Create seamless map of Mosaic US imagery
# Author:      Hamid Kiavarz
# Created:     06/2020
#-------------------------------------------------------------------------------
import glob
from os import path
import arcpy, os ,timeit
import json
import logging
from arcpy.sa import *
from multiprocessing import Pool
import os.path
import logging
from os.path import dirname, abspath
from os import path
arcpy.CheckOutExtension("Spatial")

def get_spatial_res(imagepath):

    cellsizeX = float(str(arcpy.GetRasterProperties_management(imagepath,'CELLSIZEX')))
    cellsizeY = float(str(arcpy.GetRasterProperties_management(imagepath,'CELLSIZEY')))
    if cellsizeY > cellsizeX:
        return str(cellsizeY)
    else:
        return str(cellsizeX)

def get_filesize(imagepath):
    return str(os.stat(imagepath).st_size)
def get_imagepath(imagepath,ext):
    imagepath = imagepath.replace('.TAB',ext)
    return imagepath
def get_year(filename,netpath):
    x = netpath.split('\\')
    years = ['2000','2001','2002','2003','2004','2005','2006','2007','2008','2009','2010','2011','2012','2013','2014','2015','2016','2017','2018','2019']
    no_years = ['199x','200x','201x']
    for item in x:
        if item in years:
            return item
            break
    # if item is not in the years list
    for item in x:
        if item in no_years:
             return item
def get_file_extension(fileName):
    extArray = fileName.split('.')
    ext = '.' + extArray[len(extArray)-1]
    if ext == '.alg':
        ext = '.jp2'
    return ext
def get_ImagePathandExt(inputFile):
    image_full_path = ''
    ext = ''
    file = ''
    tab_File = open(inputFile, 'r')
    all_lines = tab_File.readlines()
    for line in all_lines:
        if 'File' in line:
            file = line.split('"')[1]
            file_name = os.path.basename(file)
            ext = get_file_extension(file)
            if os.path.exists(inputFile.replace(".TAB", ext)):
                image_full_path = inputFile.replace(".TAB", ext)
                break
            else:
                image_full_path = os.path.join(find_file(os.path.dirname(inputFile), os.path.basename(file)),file_name)
                break
    return [image_full_path,ext]
def get_Image_Metadata(imagepath,extension,FID):
    originalFID = 'NA'
    bits = 'NA'
    width = 'NA'
    length = 'NA'
    ext = 'NA'
    geoRef = 'Y'
    fileSize = 'NA'
    spatial_res = 'NA'

    originalFID = str(FID)
    bits = arcpy.GetRasterProperties_management(imagepath,'VALUETYPE')
    width = arcpy.GetRasterProperties_management(imagepath,'COLUMNCOUNT')
    length = arcpy.GetRasterProperties_management(imagepath,'ROWCOUNT')
    ext = extension.split('.')[1]
    fileSize = get_filesize(imagepath)
    spatial_res = get_spatial_res(imagepath)
    desc = arcpy.Describe(imagepath)
    year = get_year(desc.baseName,desc.path)

    return [originalFID, bits, width, length, ext, geoRef, fileSize, imagepath, spatial_res, year]
def get_Footprint(inputRaster):
    try:
        ws = arcpy.env.scratchFolder
        arcpy.env.workspace = ws
        srWGS84 = arcpy.SpatialReference('WGS 1984')
        tmpGDB =os.path.join(ws,r"temp.gdb")
        if not os.path.exists(tmpGDB):
            arcpy.CreateFileGDB_management(ws,r"temp.gdb")

        # Calcuate Footprint geometry
        resampleRaster = os.path.join(ws,'resampleRaster' + '.tif')
        bin_Raster = os.path.join(ws,'bin_Raster' + '.tif')
        polygon_with_holes= os.path.join(tmpGDB,'polygon_with_holes')
        out_Vertices = os.path.join(tmpGDB,'Out_Vertices')

        arcpy.AddMessage('Start resampling the input raster...')
        start1 = timeit.default_timer()
        rasterProp = arcpy.GetRasterProperties_management(inputRaster, "CELLSIZEX")
        resampleRaster = arcpy.Resample_management(inputRaster,resampleRaster ,4, "NEAREST")
        inputSR = arcpy.Describe(resampleRaster).spatialReference
        end1 = timeit.default_timer()
        arcpy.AddMessage(('End resampling the input raster. Duration:', round(end1 -start1,4)))


        arcpy.AddMessage('Start creating binary raster (Raster Calculator)...')
        start2 = timeit.default_timer()
        expression = 'Con(' + '"' + 'resampleRaster' + '.tif' + '"' + ' >= 10 , 1)'
        bin_Raster = arcpy.gp.RasterCalculator_sa(expression, bin_Raster)
        end2 = timeit.default_timer()
        arcpy.AddMessage(('End creating binary raster. Duration:', round(end2 -start2,4)))

        # Convert binary raster to polygon
        arcpy.AddMessage('Start creating prime polygon from raster...')
        start3 = timeit.default_timer()
        # arcpy.RasterToPolygon_conversion(bin_Raster, 'primePolygon.shp', "SIMPLIFY", "VALUE")
        polygon_with_holes =  arcpy.RasterToPolygon_conversion(in_raster= bin_Raster, out_polygon_features=polygon_with_holes, simplify="SIMPLIFY", raster_field="Value", create_multipart_features="SINGLE_OUTER_PART", max_vertices_per_feature="")
        end3 = timeit.default_timer()
        arcpy.AddMessage(('End creating polygon. Duration:', round(end3 -start3,4)))

        ### extract the main polygon (with maximum area) which includes several donuts
        arcpy.AddMessage('Start extracting exterior ring (outer outline) of polygon...')
        start4 = timeit.default_timer()
        sql_clause = (None, 'ORDER BY Shape_Area DESC')
        geom = arcpy.Geometry()
        row = arcpy.da.SearchCursor(polygon_with_holes,('SHAPE@'),None,None,False,sql_clause).next()
        geom = row[0]
        end4 = timeit.default_timer()
        arcpy.AddMessage(('End extracting polygon. Duration:', round(end4 -start4,4)))

        ### extract the exterior points from main polygon to generate pure polygon from ouer line of main polygon
        arcpy.AddMessage('Start extracting exterior points ...')
        start5 = timeit.default_timer()
        outer_coords = []
        for island in geom.getPart():
            # arcpy.AddMessage("Vertices in island: {0}".format(island.count))
            for point in island:
                # coords.append = (point.X,point.Y)
                if not isinstance(point, type(None)):
                    newPoint = (point.X,point.Y)
                    if len(outer_coords) == 0:
                        outer_coords.append(newPoint)
                    elif not newPoint == outer_coords[0]:
                        outer_coords.append((newPoint))
                    elif len(outer_coords) > 50:
                        outer_coords.append((newPoint))
                        break

        # # # # points_FC = arcpy.CreateFeatureclass_management(tmpGDB,"points_FC", "POINT", "", "DISABLED", "DISABLED", inputSR)
        # # # # i = 0
        # # # # with arcpy.da.InsertCursor(points_FC,["SHAPE@XY"]) as cursor:
        # # # #     for coord in outer_coords:
        # # # #         cursor.insertRow([coord])
        # # # #         i+= 1
        # # # #         if i > 2:
        # # # #             break
        # # # #     del cursor

        ### Create footprint  featureclass -- > polygon
        footprint_FC = arcpy.CreateFeatureclass_management(tmpGDB,"footprint_FC", "POLYGON", "", "DISABLED", "DISABLED", inputSR)
        cursor = arcpy.da.InsertCursor(footprint_FC, ['SHAPE@'])
        cursor.insertRow([arcpy.Polygon(arcpy.Array([arcpy.Point(*coords) for coords in outer_coords]),inputSR)])
        del cursor
        end5 = timeit.default_timer()
        arcpy.AddMessage(('End extracting exterior points and inserted as FC. Duration:', round(end5 -start5,4)))

        arcpy.AddMessage('Start simplifying footprint polygon...')
        start6 = timeit.default_timer()
        arcpy.Generalize_edit(footprint_FC, '100 Meter')
        finalGeometry = (arcpy.da.SearchCursor(footprint_FC,('SHAPE@')).next())[0]
        end6 = timeit.default_timer()
        arcpy.AddMessage(('End simplifying footprint polygon. Duration:', round(end6 -start6,4)))
        footprint_WGS84 = finalGeometry.projectAs(srWGS84)
        return(footprint_WGS84)
    except:
        msgs = "ArcPy ERRORS:\n %s\n"%arcpy.GetMessages(2)
        arcpy.AddError(msgs)
        raise
def UpdateSeamlessFC(DQQQ_footprint_FC,metaData,ft_Polygon):
    arcpy.AddMessage('Start Uploading to seamless FC...')
    start7 = timeit.default_timer()
    srWGS84 = arcpy.SpatialReference('WGS 1984')
    insertRow = arcpy.da.InsertCursor(DQQQ_footprint_FC, ['Original_FID','BITS','WIDTH','LENGTH','EXT','GEOREF','FILESIZE','IMAGEPATH','SPATIAL_RESOLUTION','YEAR','SHAPE@'])
    rowtuple=[str(metaData[0]),str(metaData[1]),str(metaData[2]),str(metaData[3]),str(metaData[4]),str(metaData[5]),str(metaData[6]),str(metaData[7]),str(metaData[8]),str(metaData[9]),ft_Polygon]
    insertRow.insertRow(rowtuple)
    end7 = timeit.default_timer()
    arcpy.AddMessage(('End Uploading to seamless FC. Duration:', round(end7 -start7,4)))
    del insertRow
def find_file(in_path, file_name):
    dest_path = None
    print(in_path)
    print(file_name)
    while True:
        if (os.path.exists(in_path)):
            for (dirpath, dirnames, filenames) in os.walk(in_path):
                 if file_name.lower() in map(lambda x:x.lower(),filenames):
                    dest_path = dirpath
                    break
            else:
                 in_path = os.path.dirname(in_path)
        else:
            in_path = os.path.dirname(in_path)
        if dest_path == None and os.path.basename(in_path) in ['199x','200x','201x']:
            dest_path = ''
            break
        if not dest_path == None:
            break 
    return  dest_path

if __name__ == '__main__':

    ws =  arcpy.env.scratchFolder
    arcpy.env.workspace = ws
    arcpy.env.overwriteOutput = True
    arcpy.AddMessage(ws)
    inputRaster = arcpy.GetParameterAsText(0)
    # DQQQ_footprint_FC = r'\\cabcvan1nas003\doqq\DOQQ_ALL_11202020\DOQQ_ALL_WGS84.shp'
    logfile = r'C:\Users\HKiavarz\Documents\log_DOQQ_seamless_unknown_path_02.txt'
    DQQQ_ALL_FC = r'\\cabcvan1nas003\doqq\DOQQ_ALL_11202020\DOQQ_ALL_WGS84.shp'
    # DQQQ_footprint_FC = r'F:\Aerial_US\USImagery\Data\Seamless_Map.gdb\DOQQ_seamless_map'
    DQQQ_footprint_FC = r'F:\Aerial_US\USImagery\Data\Seamless_Map.gdb\DOQQ_Seamless_map_unknowPath'

    logger = logging.getLogger(__name__)
    logger.setLevel(logging.WARNING)
    handler = logging.FileHandler(logfile)
    handler.setLevel(logging.WARNING)
    logger.addHandler(handler)

    startTotal = timeit.default_timer()

    srWGS84 = arcpy.SpatialReference('WGS 1984')

    params =[]

    # expression = "FID >= 170000 AND FID <= 170691"
    # expression = "FID = 35"
    list = [
139282,
139283,
139284,
139285,
139286,
139287,
139288,
139289,
139290,
139291,
139292,
139293,
139294,
139295,
139296,
139297,
139298,
139299,
139300,
139301,
139302,
139303,
139304,
139305,
139306,
139307,
139308,
139309,
139310,
139311,
139312,
139313,
139314,
139315,
139316,
139317,
139318,
139319,
139320,
139321,
139322,
139323,
139324,
139325,
139326,
139327,
139328,
139329,
139330,
139331,
139332,
139333,
139334,
139335,
139336,
139337,
139338,
139339,
139340,
139341,
139342,
139343,
139344,
139345,
139346,
139347,
139348,
139349,
139350,
139351,
139352,
139353,
139354,
139355,
139356,
139357,
139358,
139359,
139360,
139361,
139362,
139363,
139364,
139365,
139366,
139367,
139368,
139369,
139370,
139371,
139372,
139373,
139374,
139375,
139376,
139377,
139378,
139379,
139380,
139381,
139382,
139383,
139384,
139385,
139386,
139387,
139388,
139389,
139390,
139391,
139392,
139393,
139394,
139395,
139396,
139397,
139398,
139399,
139400,
139401,
139402,
139403,
139404,
139405,
139406,
139407,
139408,
139409,
139410,
139411,
139412,
139413,
139414,
139415,
139416,
139417,
139418,
139419,
139420,
139421,
139422,
139423,
139424,
139425,
139426,
139427,
139428,
139429,
139430,
139431,
139432,
139433,
139434,
139435,
139436,
139437,
139438,
139439,
139440,
139441,
139442,
139443,
139444,
139445,
139446,
139447,
139448,
139449,
139450,
139451,
139452,
139453,
139454,
139455,
139456,
139457,
139458,
139459,
139460,
139461,
139462,
139463,
139464,
139465,
139466,
139467,
139468,
139469,
139470,
139471,
139472,
139473,
139474,
139475,
139476,
139477,
139478,
139479,
139480,
139481,
139482,
139483,
139484,
139485,
139486,
139487,
139488,
139489,
139490,
139491,
139492,
139493,
139494,
139495,
139496,
139497,
139498,
139499,
139500,
139501,
139502,
139503,
139504,
139505,
139506,
139507,
139508,
139509,
139510,
139511,
139512,
139513,
139514,
139515,
139516,
139517,
139518,
139519,
139520,
139521,
139522,
139523,
139524,
139525,
139526,
139527,
139528,
139529,
139530,
139531,
139532,
139533,
139534,
139535,
139536,
139537,
139538,
139539,
139540,
139541,
139542,
139876,
139877,
139878,
139879,
139880,
139881,
139882,
139883,
139885,
139886,
139887,
139888,
139889,
139890,
139891,
139892,
139893,
139894,
139895,
139896,
139897,
139898,
139899,
139900,
139901,
139902,
139903,
139904,
139905,
139906,
139907,
139908,
139909,
139910,
139911,
139912,
139913,
139914,
139915,
139916,
139918,
139939,
139940,
139941,
139948,
139958,
139959,
139960,
139961,
139962,
139963,
139964,
139965,
139966,
139967,
139968,
139969,
139970,
139971,
139972,
139973,
139974,
139975,
139976,
139977,
139978,
139979,
139980,
139981,
139982,
139983,
139984,
139985,
139986,
139987,
139988,
139989,
139990,
139991,
139992,
139993,
139994,
139995,
139996,
139997,
139998,
139999,
140000,
140001,
140002,
140003,
140004,
140005,
140006,
140007,
140008,
140009,
140010,
140011,
140012,
140013,
140014,
140015,
140016,
140017,
140018,
140020,
140021,
140022,
140023,
140024,
140025,
140026,
140027,
140028,
140029,
140030,
140031,
140032,
140033,
140034,
140035,
140036,
140037,
140038,
140039,
140040,
140041,
140261,
140262,
140263,
140264,
142226,
142227,
143710,
143711,
143712,
143713,
143714,
143715,
143716,
143717,
143718,
143719,
143720,
143721,
143722,
143723,
143724,
143725,
143726,
143727,
143728,
143729,
143730,
143731,
143732,
143733,
143734,
143735,
143736,
143737,
143738,
143739,
143740,
143741,
143742,
143743,
143744,
143745,
143746,
143747,
143748,
143749,
143750,
143751,
143752,
143753,
143754,
143755,
143756,
143757,
143758,
143759,
143760,
143761,
143762,
143763,
143764,
143765,
143766,
143767,
143768,
143769,
143770,
143771,
143772,
143773,
143774,
143775,
143776,
143777,
143778,
143779,
143780,
143781,
143782,
143783,
143784,
143785,
143786,
143787,
143788,
143789,
143790,
143791,
143792,
143793,
143794,
143795,
143796,
143797,
143798,
143799,
143800,
143801,
143802,
143803,
143804,
143805,
143806,
143807,
143808,
143809,
143810,
143811,
143812,
143813,
143814,
143815,
143816,
143817,
143818,
143819,
143820,
143821,
143822,
143823,
143824,
143825,
143826,
143827,
143828,
143829,
143830,
143831,
143832,
143833,
143834,
143835,
143836,
143837,
143838,
143839,
143840,
143841,
143842,
143843,
143844,
143845,
143846,
143847,
143848,
143849,
143850,
143851,
143852,
143853,
143854,
143855,
143856,
143857,
143858,
143859,
143860,
143861,
143862,
143863,
143864,
143865,
143866,
143867,
143868,
143869,
143870,
143871,
143872,
143873,
143874,
143875,
143876,
143877,
143878,
143879,
143880,
143881,
143882,
143883,
143884,
143885,
143886,
143887,
143888,
143889,
143890,
143891,
143892,
143893,
143894,
143895,
143896,
143897,
143898,
143899,
143900,
143901,
143902,
143903,
143904,
143905,
143906,
143907,
143908,
143909,
143910,
143911,
143912,
143913,
143914,
143915,
143916,
143917,
143918,
143919,
143920,
143921,
143922,
143923,
143924,
143925,
143926,
143927,
143928,
143929,
143930,
143931,
143932,
143933,
143934,
143935,
143936,
143937,
143938,
143939,
143940,
143941,
143942,
143943,
143944,
143945,
143946,
143947,
143948,
143949,
143950,
143951,
143952,
143953,
143954,
143955,
143956,
143957,
143958,
143959,
143960,
143961,
143962,
143963,
143964,
143965,
143966,
143967,
143968,
143969,
143970,
143971,
143972,
143973,
143974,
143975,
143976,
143977,
143978,
143979,
143980,
143981,
143982,
143983,
143984,
143985,
143986,
143987,
143988,
143989,
143990,
143991,
143992,
143993,
143994,
143995,
143996,
143997,
143998,
143999,
144000,
144001,
144002,
144003,
144004,
144005,
144006,
144007,
144008,
144009,
144010,
144011,
144012,
144013,
144014,
144015,
144016,
144017,
144018,
144019,
144020,
144021,
144022,
144023,
144024,
144025,
144026,
144027,
144028,
144029,
144030,
144031,
144032,
144033,
144034,
144035,
144036,
144037,
144038,
144039,
144040,
144041,
144042,
144043,
144044,
144045,
144046,
144047,
144048,
144049,
144050,
144051,
144052,
144053,
144054,
144055,
144056,
144057,
144058,
144059,
144060,
144061,
144062,
144063,
144064,
144065,
144066,
144067,
144068,
144069,
144070,
144071,
144072,
144073,
144074,
144075,
144076,
144077,
144078,
144079,
144080,
144081,
144082,
144083,
144084,
144085,
144086,
144087,
144088,
144089,
144090,
144091,
144092,
144093,
144094,
144095,
144096,
144097,
144098,
144099,
144100,
144101,
144102,
144103,
144104,
144105,
144106,
144107,
144108,
144109,
144110,
144111,
144112,
144113,
144114,
144115,
144116,
144117,
144118,
144119,
144120,
144121,
144122,
144123,
144124,
144125,
144126,
144127,
144128,
144129,
144130,
144131,
144132,
144133,
144134,
144135,
144136,
144137,
144138,
144139,
144140,
144141,
144142,
144143,
144144,
144145,
144146,
144147,
144148,
144149,
144150,
144151,
144152,
144153,
144154,
144155,
144156,
144157,
144158,
144159,
144160,
144161,
144162,
144163,
144164,
144165,
144166,
144167,
144168,
144169,
144170,
144171,
144172,
144173,
144174,
144175,
144176,
144177,
144178,
144179,
144180,
144181,
144182,
144183,
144184,
144185,
144186,
144187,
144188,
144189,
144190,
144191,
144192,
144193,
144194,
144195,
144196,
144197,
144198,
144199,
144200,
144201,
144202,
144203,
144204,
144205,
144206,
144207,
144208,
144209,
144210,
144211,
144212,
144213,
144214,
144215,
144216,
144217,
144218,
144219,
144220,
144221,
144222,
144223,
144224,
144225,
144226,
144227,
144228,
144229,
144230,
144231,
144232,
144233,
144234,
144235,
144236,
144237,
144238,
144239,
144240,
144241,
144242,
144243,
144244,
144245,
144246,
144247,
144248,
144249,
144250,
144251,
144252,
144253,
144254,
144255,
144256,
144257,
144258,
144259,
144260,
144261,
144262,
144263,
144264,
144265,
144266,
144267,
144268,
144269,
144270,
144271,
144272,
144273,
144274,
144275,
144276,
144277,
144278,
144279,
144280,
144281,
144282,
144283,
144284,
144285,
144286,
144287,
144288,
144289,
144290,
144291,
144292,
144293,
144294,
144295,
144296,
144297,
144298,
144299,
144300,
144301,
144302,
144303,
144304,
144305,
144306,
144307,
144308,
144309,
144310,
144311,
144312,
144313,
144314,
144315,
144316,
144317,
144318,
144319,
144320,
144321,
144322,
144323,
144324,
144325,
144326,
144327,
144328,
144329,
144330,
144331,
144332,
144333,
144334,
144335,
144336,
144337,
144338,
144339,
144340,
144341,
144342,
144343,
144344,
144345,
144346,
144347,
144348,
144349,
144350,
144351,
144352,
144353,
144354,
144355,
144356,
144357,
144358,
144359,
144360,
144361,
144362,
144363,
144364,
144365,
144366,
144367,
144368,
144369,
144370,
144371,
144372,
144373,
144374,
144375,
144376,
144377,
144378,
144379,
144380,
144381,
144382,
144383,
144384,
144385,
144386,
144387,
144388,
144389,
144390,
144391,
144392,
144393,
144394,
144395,
144396,
144397,
144398,
144399,
144400,
144401,
144402,
144403,
144404,
144405,
144406,
144407,
144408,
144409,
144410,
144411,
144412,
144413,
144414,
144415,
144416,
144417,
144418,
144419,
144420,
144421,
144422,
144423,
144424,
144425,
144426,
144427,
144428,
144429,
144430,
144431,
144432,
144433,
144434,
144435,
144436,
144437,
144438,
144439,
144440,
144441,
144442,
144443,
144444,
144445,
144446,
144447,
144448,
144449,
144450,
144451,
144452,
144453,
144454,
144455,
144456,
144457,
144458,
144459,
144460,
144461,
144462,
144463,
144464,
144465,
144466,
144467,
144468,
144469,
144470,
144471,
144472,
144473,
144474,
144475,
144476,
144477,
144478,
144479,
144480,
144481,
144482,
144483,
144484,
144485,
144486,
144487,
144488,
144489,
144490,
144491,
144492,
144493,
144494,
144495,
144496,
144497,
144498,
144499,
144500,
144501,
144502,
144503,
144504,
144505,
144506,
144507,
144508,
144509,
144510,
144511,
144512,
144513,
144514,
144515,
144516,
144517,
144518,
144519,
144520,
144521,
144522,
144523,
144524,
144525,
144526,
144527,
144528,
144529,
144530,
144531,
144532,
144533,
144534,
144535,
144536,
144537,
144538,
144539,
144540,
144541,
144542,
144543,
144544,
144545,
144546,
144547,
144548,
144549,
144550,
144551,
144552,
144553,
144554,
144555,
144556,
144557,
144558,
144559,
144560,
144561,
144562,
144564,
144565,
144566,
144567,
144568,
144569,
144570,
144571,
144572,
144573,
144574,
144575,
144576,
144577,
144578,
144579,
144580,
144581,
144582,
144583,
144584,
144585,
144587,
144588,
144589,
144591,
144592,
144593,
144594,
144595,
144596,
144597,
144598,
144599,
144600,
144601,
144602,
144603,
144604,
144605,
144606,
144607,
144608,
144609,
144610,
144611,
144612,
144613,
144614,
144615,
144616,
144617,
144618,
144619,
144620,
144621,
144622,
144623,
144624,
144625,
144626,
144627,
144628,
144629,
144630,
144631,
144632,
144633,
144634,
144635,
144636,
144637,
144638,
144639,
144640,
144642,
144643,
144644,
144645,
144646,
144647,
144648,
144649,
144650,
144651,
144652,
144653,
144655,
144656,
144657,
144658,
144659,
144660,
144661,
144662,
144663,
144664,
144665,
144666,
144667,
144668,
144669,
144671,
144672,
144673,
144674,
144675,
144676,
144677,
144678,
144679,
144680,
144681,
144682,
144683,
144684,
144685,
144686,
144687,
144688,
144689,
144690,
144691,
144692,
144693,
144694,
144695,
144696,
144697,
144698,
144699,
144700,
144701,
144702,
144703,
144704,
144705,
144706,
144707,
144708,
144709,
144710,
144711,
144712,
144713,
144714,
144715,
144716,
144717,
144718,
144719,
144720,
144721,
144722,
144723,
144724,
144725,
144726,
144727,
144728,
144729,
144730,
144731,
144732,
144733,
144734,
144735,
144736,
144737,
144738,
144739,
144740,
144741,
144742,
144743,
144744,
144745,
144746,
144747,
144748,
144749,
144750,
144751,
144752,
144753,
144754,
144755,
144756,
144757,
144758,
144759,
144760,
144761,
144762,
144763,
144764,
144765,
144766,
144767,
144768,
144769,
144770,
144771,
144772,
144773,
144774,
144775,
144776,
144777,
144778,
144779,
144780,
144781,
144782,
144783,
144784,
144785,
144786,
144787,
144788,
144789,
144790,
144791,
144792,
144793,
144794,
144795,
144796,
144797,
144798,
144799,
144800,
144801,
144802,
144803,
144804,
144805,
144806,
144807,
144808,
144809,
144810,
144811,
144812,
144813,
144814,
144815,
144816,
144817,
144818,
144819,
144820,
144821,
144822,
144823,
144824,
144825,
144826,
144827,
144828,
144829,
144830,
144831,
144832,
144833,
144834,
144835,
144836,
144837,
144838,
144839,
144840,
144841,
144842,
144843,
144844,
144845,
144846,
144847,
144848,
144849,
144850,
144851,
144852,
144853,
144854,
144855,
144856,
144857,
144858,
144859,
144860,
144861,
144862,
144863,
144864,
144865,
144866,
144867,
144868,
144869,
144870,
144871,
144872,
144873,
144874,
144875,
144876,
144877,
144878,
144879,
144880,
144881,
144882,
144883,
144884,
144885,
144886,
144887,
144888,
144889,
144890,
144891,
144892,
144893,
144894,
144895,
144896,
144897,
144898,
144899,
144900,
144901,
144902,
144903,
144904,
144905,
144906,
144907,
144908,
144909,
144910,
144911,
144912,
144913,
144914,
144915,
144916,
144917,
144918,
144919,
144920,
144921,
144922,
144923,
144924,
144925,
144926,
144927,
144928,
144929,
144930,
144931,
144932,
144933,
144934,
144935,
144936,
144937,
144938,
144939,
144940,
144941,
144942,
144943,
144944,
144945,
144946,
144947,
144948,
144949,
144950,
144951,
144952,
144953,
144954,
144955,
144956,
144957,
144958,
144959,
144960,
144961,
144962,
144963,
144964,
144965,
144966,
144967,
144968,
144969,
144970,
144971,
144972,
144973,
144974,
144975,
144976,
144977,
144978,
144979,
144980,
144981,
144982,
144983,
144984,
144985,
144986,
144987,
144988,
144989,
144990,
144991,
144992,
144993,
144994,
144995,
144996,
144997,
144998,
144999,
145000,
145001,
145002,
145003,
145004,
145005,
145006,
145007,
145008,
145009,
145010,
145011,
145012,
145013,
145014,
145015,
145016,
145017,
145018,
145019,
145020,
145021,
145022,
145023,
145024,
145025,
145026,
145027,
145028,
145029,
145030,
145031,
145032,
145033,
145034,
145035,
145036,
145037,
145038,
145039,
145040,
145041,
145042,
145043,
145044,
145045,
145046,
145047,
145048,
145049,
145050,
145051,
145052,
145053,
145054,
145055,
145056,
145057,
145058,
145059,
145060,
145061,
145062,
145063,
145064,
145065,
145066,
145067,
145068,
145069,
145070,
145071,
145072,
145073,
145074,
145075,
145076,
145077,
145078,
145079,
145080,
145081,
145082,
145083,
145084,
145085,
145086,
145087,
145088,
145089,
145090,
145091,
145092,
145093,
145094,
145095,
145096,
145097,
145098,
145099,
145100,
145101,
145102,
145103,
145104,
145105,
145106,
145107,
145108,
145109,
145110,
145111,
145112,
145113,
145114,
145115,
145116,
145117,
145118,
145119,
145120,
145121,
145122,
145123,
145124,
145125,
145126,
145127,
145128,
145129,
145130,
145131,
145132,
145133,
145134,
145135,
145136,
145137,
145138,
145139,
145140,
145141,
145142,
145143,
145144,
145145,
145146,
145147,
145148,
145149,
145150,
145151,
145152,
145153,
145154,
145155,
145156,
145157,
145158,
145159,
145160,
145161,
145162,
145163,
145164,
145165,
145166,
145167,
145168,
145169,
145170,
145171,
145172,
145173,
145174,
145175,
145176,
145177,
145178,
145179,
145180,
145181,
145182,
145183,
145184,
145185,
145186,
145187,
145188,
145189,
145190,
145191,
145192,
145193,
145194,
145195,
145196,
145197,
145198,
145199,
145200,
145201,
145202,
145203,
145204,
145205,
145206,
145207,
145208,
145209,
145210,
145211,
145212,
145213,
145214,
145215,
145216,
145217,
145218,
145219,
145220,
145221,
145222,
145223,
145224,
145225,
145226,
145227,
145228,
145229,
145230,
145231,
145232,
145233,
145234,
145235,
145236,
145237,
145238,
145239,
145240,
145241,
145242,
145243,
145244,
145245,
145246,
145247,
145248,
145249,
145250,
145251,
145252,
145253,
145254,
145255,
145256,
145257,
145258,
145259,
145260,
145261,
145262,
145263,
145264,
145265,
145266,
145267,
145268,
145269,
145270,
145271,
145272,
145273,
145274,
145275,
145276,
145277,
145278,
145279,
145280,
145281,
145282,
145283,
145284,
145285,
145286,
145287,
145288,
145289,
145290,
145291,
145292,
145293,
145294,
145295,
145296,
145297,
145298,
145299,
145300,
145301,
145302,
145303,
145304,
145305,
145306,
145307,
145308,
145309,
145310,
145311,
145312,
145313,
145314,
145315,
145316,
145317,
145318,
145319,
145320,
145321,
145322,
145323,
145324,
145325,
145326,
145327,
145328,
145329,
145330,
145331,
145332,
145333,
145334,
145335,
145336,
145337,
145338,
145339,
145340,
145341,
145342,
145343,
145344,
145345,
145346,
145347,
145348,
145349,
145350,
145351,
145352,
145353,
145354,
145355,
145356,
145357,
145358,
145399,
145400,
145401,
145402,
145403,
145404,
145405,
145406,
145407,
145408,
145409,
145410,
145411,
145412,
145413,
145414,
145415,
145416,
145417,
145418,
145419,
145420,
145421,
145422,
145423,
145424,
145425,
145426,
145427,
145428,
145429,
145430,
145431,
145432,
145433,
145434,
145435,
145436,
145437,
145438,
145439,
145440,
145441,
145442,
145443,
145444,
145445,
145446,
145447,
145448,
145449,
145450,
145451,
145452,
145453,
145454,
145455,
145456,
145457,
145458,
145459,
145460,
145461,
145462,
145463,
145464,
145465,
145466,
145467,
145468,
145469,
145470,
145471,
145472,
145473,
145474,
145475,
145476,
145477,
145478,
145479,
145480,
145481,
145482,
145483,
145484,
145485,
145486,
145487,
145488,
145489,
145490,
145491,
145492,
145493,
145494,
145495,
145496,
145497,
145498,
145499,
145500,
145501,
145502,
145503,
145504,
145505,
145506,
145507,
145508,
145509,
145510,
145511,
145512,
145513,
145514,
145515,
145516,
145517,
145518,
145519,
145520,
145521,
145522,
145523,
145524,
145525,
145526,
145527,
145528,
145529,
145530,
145531,
145532,
145533,
145534,
145535,
145536,
145537,
145538,
145539,
145540,
145541,
145542,
145543,
145544,
145545,
145546,
145547,
145548,
145549,
145550,
145551,
145552,
145553,
145554,
145555,
145556,
145557,
145558,
145559,
145560,
145561,
145562,
145563,
145564,
145565,
145566,
145567,
145568,
145569,
145570,
145571,
145572,
145573,
145574,
145575,
145576,
145577,
145578,
145579,
145580,
145581,
145582,
145583,
145584,
145585,
145586,
145587,
145588,
145589,
145590,
145591,
145592,
145593,
145594,
145595,
145596,
145597,
145598,
145599,
145600,
145601,
145602,
145603,
145604,
145605,
145606,
145607,
145608,
145609,
145610,
145611,
145612,
145613,
145614,
145615,
145616,
145617,
145618,
145619,
145620,
145621,
145622,
145623,
145624,
145625,
145626,
145627,
145628,
145629,
145630,
145631,
145632,
145633,
145634,
145635,
145636,
145637,
145638,
145639,
145640,
145641,
145642,
145643,
145644,
145645,
145646,
145647,
145648,
145649,
145650,
145651,
145652,
145653,
145654,
145655,
145656,
145659,
145660,
145661,
145662,
145663,
145664,
145665,
145666,
145667,
145668,
145669,
145670,
145671,
145672,
145673,
145674,
145675,
145676,
145677,
145678,
145679,
145680,
145681,
145682,
145683,
145684,
145685,
145686,
145687,
145688,
145689,
145690,
145691,
145692,
145693,
145694,
145695,
145696,
145697,
145698,
145699,
145700,
145701,
145702,
145703,
145704,
145705,
145706,
145707,
145708,
145709,
145710,
145711,
145712,
145713,
145714,
145715,
145716,
145717,
145718,
145719,
145720,
145721,
145722,
145723,
145724,
145725,
145726,
145727,
145728,
145729,
145730,
145731,
145732,
145733,
145734,
145735,
145736,
145737,
145738,
145739,
145740,
145741,
145742,
145743,
145744,
145745,
145746,
145747,
145748,
145749,
145750,
145751,
145752,
145753,
145754,
145755,
145756,
145757,
145758,
145759,
145760,
145761,
145762,
145763,
145764,
145765,
145766,
145767,
145768,
145769,
145770,
145771,
145772,
145773,
145774,
145775,
145776,
145777,
145778,
145779,
145780,
145781,
145782,
145783,
145784,
145785,
145786,
145787,
145788,
145789,
145790,
145791,
145792,
145793,
145794,
145795,
145796,
145797,
145798,
145799,
145800,
145801,
145802,
145803,
145804,
145805,
145806,
145807,
145808,
145809,
145810,
145811,
145812,
145813,
145814,
145815,
145816,
145817,
145818,
145819,
145820,
145821,
145822,
145823,
145824,
145825,
145826,
145827,
145828,
145829,
145830,
145831,
145832,
145833,
145834,
145835,
145836,
145837,
145838,
145839,
145840,
145841,
145842,
145843,
145844,
145845,
145846,
145847,
145848,
145849,
145850,
145851,
145852,
145853,
145854,
145855,
145856,
145857,
145858,
145859,
145860,
145861,
145862,
145863,
145864,
145865,
145866,
145867,
145868,
145869,
145870,
145871,
145872,
145873,
145874,
145875,
145876,
145877,
145878,
145879,
145880,
145881,
145882,
145883,
145884,
145885,
145886,
145887,
145888,
145889,
145890,
145891,
145892,
145893,
145894,
145895,
145896,
145897,
145898,
145899,
145900,
145901,
145902,
145903,
145904,
145905,
145906,
145907,
145908,
145909,
145910,
145911,
145912,
145913,
145914,
145915,
145916,
145917,
145918,
145919,
145920,
145921,
145922,
145923,
145924,
145925,
145926,
145927,
145928,
145929,
145930,
145931,
145932,
145933,
145934,
145935,
145936,
145937,
145938,
145939,
145940,
145941,
145942,
145943,
145944,
145945,
145946,
145947,
145948,
145949,
145950,
145951,
145952,
145953,
145954,
145955,
145956,
145957,
145958,
145959,
145960,
145961,
145962,
145963,
145964,
145965,
145966,
145967,
145968,
145969,
145970,
145971,
145972,
145973,
145974,
145975,
145976,
145977,
145978,
145979,
145980,
145981,
145982,
145983,
145984,
145985,
145986,
145987,
145988,
145989,
145990,
145991,
145992,
145993,
145994,
145995,
145996,
145997,
145998,
145999,
146000,
146001,
146002,
146003,
146004,
146005,
146006,
146007,
146008,
146009,
146010,
146011,
146012,
146013,
146014,
146015,
146016,
146017,
146018,
146019,
146020,
146021,
146022,
146023,
146024,
146025,
146026,
146027,
146028,
146029,
146030,
146031,
146032,
146033,
146034,
146035,
146036,
146037,
146038,
146039,
146040,
146041,
146042,
146043,
146044,
146045,
146046,
146047,
146048,
146049,
146050,
146051,
146052,
146053,
146054,
146055,
146056,
146057,
146058,
146059,
146060,
146061,
146062,
146063,
146064,
146065,
146066,
146067,
146068,
146069,
146070,
146071,
146072,
146073,
146074,
146075,
146076,
146077,
146078,
146079,
146080,
146081,
146082,
146083,
146084,
146085,
146086,
146087,
146088,
146089,
146090,
146091,
146092,
146093,
146094,
146095,
146096,
146097,
146098,
146099,
146100,
146101,
146102,
146103,
146104,
146105,
146106,
146107,
146108,
146109,
146110,
146111,
146112,
146113,
146114,
146115,
146116,
146117,
146118,
146119,
146120,
146121,
146122,
146123,
146124,
146125,
146126,
146127,
146128,
146129,
146130,
146131,
146132,
146133,
146134,
146135,
146136,
146137,
146138,
146139,
146140,
146141,
146142,
146143,
146144,
146145,
146146,
146147,
146148,
146149,
146150,
146151,
146152,
146153,
146154,
146155,
146156,
146157,
146158,
146159,
146160,
146161,
146162,
146163,
146164,
146165,
146166,
146167,
146168,
146169,
146170,
146171,
146172,
146173,
146174,
146175,
146176,
146177,
146178,
146179,
146180,
146181,
146182,
146183,
146184,
146185,
146186,
146187,
146188,
146189,
146190,
146191,
146192,
146193,
146194,
146195,
146196,
146197,
146198,
146199,
146200,
146201,
146202,
146203,
146204,
146205,
146206,
146207,
146208,
146209,
146210,
146211,
146212,
146213,
146214,
146215,
146216,
146217,
146218,
146219,
146220,
146221,
146222,
146223,
146224,
146225,
146226,
146227,
146228,
146229,
146230,
146231,
146232,
146233,
146234,
146235,
146236,
146237,
146238,
146239,
146240,
146241,
146242,
146243,
146244,
146245,
146246,
146247,
146248,
146249,
146250,
146251,
146252,
146253,
146254,
146255,
146256,
146257,
146258,
146259,
146260,
146261,
146262,
146263,
146264,
146265,
146266,
146267,
146268,
146269,
146270,
146271,
146272,
146273,
146274,
146275,
146276,
146277,
146278,
146279,
146280,
146281,
146282,
146283,
146284,
146285,
146286,
146287,
146288,
146289,
146290,
146291,
146292,
146293,
146294,
146295,
146296,
146297,
146298,
146299,
146300,
146301,
146302,
146303,
146304,
146305,
146306,
146307,
146308,
146309,
146310,
146311,
146312,
146313,
146314,
146315,
146316,
146317,
146318,
146319,
146320,
146321,
146322,
146323,
146324,
146325,
146326,
146327,
146328,
146329,
146330,
146331,
146332,
146333,
146334,
146335,
146336,
146337,
146338,
146339,
146340,
146341,
146342,
146343,
146344,
146345,
146346,
146347,
146348,
146349,
146350,
146351,
146352,
146353,
146354,
146355,
146356,
146357,
146358,
146359,
146360,
146361,
146362,
146363,
146364,
146365,
146366,
146367,
146368,
146369,
146370,
146371,
146372,
146373,
146374,
146375,
146376,
146377,
146378,
146379,
146380,
146381,
146382,
146383,
146384,
146385,
146386,
146387,
146388,
146389,
146390,
146391,
146392,
146393,
146394,
146395,
146396,
146397,
146398,
146399,
146400,
146401,
146402,
146403,
146404,
146405,
146406,
146407,
146408,
146409,
146410,
146411,
146412,
146413,
146414,
146415,
146416,
146417,
146418,
146419,
146420,
146421,
146422,
146423,
146424,
146425,
146426,
146427,
146428,
146429,
146430,
146431,
146432,
146433,
146434,
146435,
146436,
146437,
146438,
146439,
146440,
146441,
146442,
146443,
146444,
146445,
146446,
146447,
146448,
146449,
146450,
146451,
146452,
146453,
146454,
146455,
146456,
146457,
146458,
146459,
146460,
146461,
146462,
146463,
146464,
146465,
146466,
146467,
146468,
146469,
146470,
146471,
146472,
146473,
146474,
146475,
146476,
146477,
146478,
146479,
146480,
146481,
146482,
146483,
146484,
146485,
146486,
146487,
146488,
146489,
146490,
146491,
146492,
146493,
146494,
146495,
146496,
146497,
146498,
146499,
146500,
146501,
146502,
146503,
146504,
146505,
146506,
146507,
146508,
146509,
146510,
146511,
146512,
146513,
146514,
146515,
146516,
146517,
146518,
146519,
146520,
146521,
146522,
146523,
146524,
146525,
146526,
146527,
146528,
146529,
146530,
146531,
146532,
146533,
146534,
146535,
146536,
146537,
146538,
146539,
146540,
146541,
146542,
146543,
146544,
146545,
146546,
146547,
146548,
146549,
146550,
146551,
146552,
146553,
146554,
146555,
146556,
146557,
146558,
146559,
146560,
146561,
146562,
146563,
146564,
146565,
146566,
146567,
146568,
146569,
146570,
146571,
146572,
146573,
146574,
146575,
146576,
146577,
146578,
146579,
146580,
146581,
146582,
146583,
146584,
146585,
146586,
146587,
146588,
146589,
146590,
146591,
146592,
146593,
146594,
146595,
146596,
146597,
146598,
146599,
146600,
146601,
146602,
146603,
146604,
146605,
146606,
146607,
146608,
146609,
146610,
146611,
146612,
146613,
146614,
146615,
146616,
146617,
146618,
146619,
146620,
146621,
146622,
146623,
146624,
146625,
146626,
146627,
146628,
146629,
146630,
146631,
146632,
146633,
146634,
146635,
146636,
146637,
146638,
146639,
146640,
146641,
146642,
146643,
146644,
146645,
146646,
146647,
146648,
146649,
146650,
146651,
146652,
146653,
146654,
146655,
146656,
146657,
146658,
146659,
146660,
146661,
146662,
146663,
146664,
146665,
146666,
146667,
146668,
146669,
146670,
146671,
146672,
146673,
146674,
146675,
146676,
146677,
146678,
146679,
146680,
146681,
146682,
146683,
146684,
146685,
146686,
146687,
146688,
146689,
146690,
146691,
146692,
146693,
146694,
146695,
146696,
146697,
146698,
146699,
146700,
146701,
146702,
146703,
146704,
146705,
146706,
146707,
146708,
146709,
146710,
146711,
146712,
146713,
146714,
146715,
146716,
146717,
146718,
146719,
146720,
146721,
146722,
146723,
146724,
146725,
146726,
146727,
146728,
146729,
146730,
146731,
146732,
146733,
146734,
146735,
146736,
146737,
146738,
146739,
146740,
146741,
146742,
146743,
146744,
146745,
146746,
146747,
146748,
146749,
146750,
146751,
146752,
146753,
146754,
146755,
146756,
146757,
146758,
146759,
146760,
146761,
146762,
146763,
146764,
146765,
146766,
146767,
146768,
146769,
146770,
146771,
146772,
146773,
146774,
146775,
146776,
146777,
146778,
146779,
146780,
146781,
146782,
146783,
146784,
146785,
146786,
146787,
146788,
146789,
146790,
146791,
146792,
146793,
146794,
146795,
146796,
146797,
146798,
146799,
146800,
146801,
146802,
146803,
146804,
146805,
146806,
146807,
146808,
146809,
146810,
146811,
146812,
146813,
146814,
146815,
146816,
146817,
146818,
146819,
146820,
146821,
146822,
146823,
146824,
146825,
146826,
146827,
146828,
146829,
146830,
146831,
146832,
146833,
146834,
146835,
146836,
146837,
146838,
146839,
146840,
146841,
146842,
146843,
146844,
146845,
146846,
146847,
146848,
146849,
146850,
146851,
146852,
146853,
146854,
146855,
146856,
146857,
146858,
146859,
146860,
146861,
146862,
146863,
146864,
146865,
146866,
146867,
146868,
146869,
146870,
146871,
146872,
146873,
146874,
146875,
146876,
146877,
146878,
146879,
146880,
146881,
146882,
146883,
146884,
146885,
146886,
146887,
146888,
146889,
146890,
146891,
146892,
146893,
146894,
146895,
146896,
146897,
146898,
146899,
146900,
146901,
146902,
146903,
146904,
146905,
146906,
146907,
146908,
146909,
146910,
146911,
146912,
146913,
146914,
146915,
146916,
146917,
146918,
146919,
146920,
146921,
146922,
146923,
146924,
146925,
146926,
146927,
146928,
146929,
146930,
146931,
146932,
146933,
146934,
146935,
146936,
146937,
146938,
146939,
146940,
146941,
146942,
146943,
146944,
146945,
146946,
146947,
146948,
146949,
146950,
146951,
146952,
146953,
146954,
146955,
146956,
146957,
146958,
146959,
146960,
146961,
146962,
146963,
146964,
146965,
146966,
146967,
146968,
146969,
146970,
146971,
146972,
146973,
146974,
146975,
146976,
146977,
146978,
146979,
146980,
146981,
146982,
146983,
146984,
146985,
146986,
146987,
146988,
146989,
146990,
146991,
146992,
146993,
146994,
146995,
146996,
146997,
146998,
146999,
147000,
147001,
147002,
147003,
147004,
147005,
147006,
147007,
147008,
147009,
147010,
147011,
147012,
147013,
147014,
147015,
147016,
147017,
147018,
147019,
147020,
147021,
147022,
147023,
147024,
147025,
147026,
147027,
147028,
147029,
147030,
147031,
147032,
147033,
147034,
147035,
147036,
147037,
147038,
147039,
147040,
147041,
147042,
147043,
147044,
147045,
147046,
147047,
147048,
147049,
147050,
147051,
147052,
147053,
147054,
147055,
147056,
147057,
147058,
147059,
147060,
147061,
147062,
147063,
147064,
147065,
147066,
147067,
147068,
147069,
147070,
147071,
147072,
147073,
147074,
147075,
147076,
147077,
147078,
147079,
147080,
147081,
147082,
147083,
147084,
147085,
147086,
147087,
147088,
147089,
147090,
147091,
147092,
147093,
147094,
147095,
147096,
147097,
147098,
147099,
147100,
147101,
147102,
147103,
147104,
147105,
147106,
147107,
147108,
147109,
147110,
147111,
147112,
147113,
147114,
147115,
147116,
147117,
147118,
147119,
147120,
147121,
147122,
147123,
147124,
147125,
147126,
147127,
147128,
147129,
147130,
147131,
147132,
147133,
147134,
147135,
147136,
147137,
147138,
147139,
147140,
147141,
147142,
147143,
147144,
147145,
147146,
147147,
147148,
147149,
147150,
147151,
147152,
147153,
147154,
147155,
147156,
147157,
147158,
147159,
147160,
147161,
147162,
147163,
147164,
147165,
147166,
147167,
147168,
147169,
147170,
147171,
147172,
147173,
147174,
147175,
147176,
147177,
147178,
147179,
147180,
147181,
147182,
147183,
147184,
147185,
147186,
147187,
147188,
147189,
147190,
147191,
147192,
147193,
147194,
147195,
147196,
147197,
147198,
147199,
147200,
147201,
147202,
147203,
147204,
147205,
147206,
147207,
147208,
147209,
147210,
147211,
147212,
147213,
147214,
147215,
147216,
147217,
147218,
147219,
147220,
147221,
147222,
147223,
147224,
147225,
147226,
147227,
147228,
147229,
147230,
147231,
147232,
147233,
147234,
147235,
147236,
147237,
147238,
147239,
147240,
147241,
147242,
147243,
147244,
147245,
147246,
147247,
147248,
147249,
147250,
147251,
147252,
147253,
147254,
147255,
147256,
147257,
147258,
147259,
147260,
147261,
147262,
147263,
147264,
147265,
147266,
147267,
147268,
147269,
147270,
147271,
147272,
147273,
147274,
147275,
147276,
147277,
147278,
147279,
147280,
147281,
147282,
147283,
147284,
147285,
147286,
147287,
147288,
147291,
147292,
147293,
147294,
147295,
147296,
147297,
147298,
147299,
147300,
147301,
147302,
147303,
147304,
147305,
147306,
147307,
147308,
147309,
147310,
147311,
147312,
147313,
147314,
147315,
147316,
147317,
147318,
147319,
147320,
147321,
147322,
147323,
147324,
147325,
147326,
147327,
147328,
147329,
147330,
147331,
147332,
147333,
147334,
147335,
147336,
147337,
147338,
147339,
147340,
147341,
147342,
147343,
147344,
147345,
147346,
147347,
147348,
147349,
147350,
147351,
147352,
147353,
147354,
147355,
147356,
147357,
147358,
147359,
147360,
147361,
147362,
147363,
147364,
147365,
147366,
147367,
147368,
147369,
147370,
147371,
147372,
147373,
147374,
147375,
147376,
147377,
147378,
147379,
147380,
147381,
147382,
147383,
147384,
147385,
147386,
147387,
147388,
147389,
147390,
147391,
147392,
147393,
147394,
147395,
147396,
147397,
147398,
147399,
147400,
147401,
147402,
147403,
147404,
147405,
147406,
147407,
147408,
147409,
147410,
147411,
147412,
147413,
147414,
147415,
147416,
147417,
147418,
147419,
147420,
147421,
147422,
147423,
147424,
147425,
147426,
147427,
147428,
147429,
147430,
147431,
147432,
147433,
147434,
147435,
147436,
147437,
147438,
147439,
147440,
147441,
147442,
147443,
147444,
147445,
147446,
147447,
147448,
147449,
147450,
147451,
147452,
147453,
147454,
147455,
147456,
147457,
147458,
147459,
147460,
147461,
147462,
147463,
147464,
147465,
147466,
147467,
147468,
147469,
147470,
147471,
147472,
147473,
147474,
147475,
147476,
147477,
147478,
147479,
147480,
147481,
147482,
147483,
147484,
147485,
147486,
147487,
147488,
147489,
147490,
147491,
147492,
147493,
147494,
147495,
147496,
147497,
147498,
147499,
147500,
147501,
147502,
147503,
147504,
147505,
147506,
147507,
147508,
147509,
147510,
147511,
147512,
147513,
147514,
147515,
147516,
147517,
147518,
147519,
147520,
147521,
147522,
147523,
147524,
147525,
147526,
147527,
147528,
147529,
147530,
147531,
147532,
147533,
147534,
147535,
147536,
147537,
147538,
147539,
147540,
147541,
147542,
147543,
147544,
147545,
147546,
147547,
147548,
147549,
147550,
147551,
147552,
147553,
147554,
147555,
147556,
147557,
147558,
147559,
147560,
147561,
147562,
147563,
147564,
147565,
147566,
147567,
147568,
147569,
147570,
147571,
147572,
147573,
147574,
147575,
147576,
147577,
147578,
147579,
147580,
147581,
147582,
147583,
147584,
147585,
147586,
147587,
147588,
147589,
147590,
147591,
147592,
147593,
147594,
147595,
147596,
147597,
147598,
147599,
147600,
147601,
147602,
147603,
147604,
147605,
147606,
147607,
147608,
147609,
147610,
147611,
147612,
147613,
147614,
147615,
147616,
147617,
147618,
147619,
147620,
147621,
147622,
147623,
147624,
147625,
147626,
147627,
147628,
147629,
147630,
147631,
147632,
147633,
147634,
147635,
147637,
147638,
147639,
147640,
147641,
147642,
147643,
147644,
147645,
147646,
147647,
147648,
147650,
147651,
147652,
147654,
147669,
147670,
147671,
147672,
147673,
147674,
147675,
147676,
147677,
147678,
147679,
147680,
147681,
147682,
147683,
147684,
147685,
147686,
147687,
147688,
147689,
147690,
147691,
147692,
147693,
147694,
147695,
147696,
147697,
147698,
147699,
147700,
147701,
147702,
147703,
147704,
147705,
147706,
147707,
147708,
147709,
147710,
147711,
147712,
147713,
147714,
147715,
147716,
147717,
147718,
147719,
147720,
147721,
147722,
147723,
147724,
147725,
147726,
147727,
147728,
147729,
147730,
147731,
147732,
147733,
147734,
147735,
147736,
147737,
147738,
147739,
147740,
147741,
147742,
147743,
147744,
147745,
147746,
147747,
147748,
147749,
147750,
147751,
147752,
147753,
147754,
147755,
147756,
147757,
147758,
147759,
147760,
147761,
147762,
147763,
147764,
147765,
147766,
147767,
147768,
147769,
147770,
147771,
147772,
147773,
147774,
147775,
147776,
147777,
147778,
147779,
147780,
147781,
147782,
147783,
147784,
147785,
147786,
147787,
147788,
147789,
147790,
147791,
147792,
147793,
147794,
147795,
147796,
147797,
147798,
147799,
147800,
147801,
147802,
147803,
147804,
147805,
147806,
147807,
147808,
147809,
147810,
147811,
147812,
147813,
147814,
147815,
147816,
147817,
147818,
147819,
147820,
147821,
147822,
147823,
147824,
147825,
147826,
147827,
147828,
147829,
147830,
147831,
147832,
147833,
147834,
147835,
147836,
147837,
147838,
147839,
147840,
147841,
147842,
147843,
147844,
147845,
147846,
147847,
147848,
147849,
147850,
147851,
147852,
147853,
147854,
147855,
147856,
147857,
147858,
147859,
147860,
147861,
147862,
147863,
147864,
147865,
147866,
147867,
147868,
147869,
147870,
147871,
147872,
147873,
147874,
147875,
147876,
147877,
147878,
147879,
147880,
147881,
147882,
147883,
147884,
147885,
147886,
147887,
147888,
147889,
147890,
147891,
147892,
147893,
147894,
147895,
147896,
147897,
147898,
147899,
147900,
147901,
147902,
147903,
147904,
147905,
147906,
147907,
147908,
147909,
147910,
147911,
147912,
147913,
147914,
147915,
147916,
147917,
147918,
147919,
147920,
147921,
147922,
147923,
147924,
147925,
147926,
147927,
147928,
147929,
147930,
147931,
147932,
147933,
147934,
147935,
147936,
147937,
147938,
147939,
147940,
147941,
147942,
147943,
147944,
147945,
147946,
147947,
147948,
147949,
147950,
147951,
147952,
147953,
147954,
147955,
147956,
147957,
147958,
147959,
147960,
147961,
147962,
147963,
147964,
147965,
147966,
147967,
147968,
147969,
147970,
147971,
147972,
147973,
147974,
147975,
147976,
147977,
147978,
147979,
147980,
147981,
147982,
147983,
147984,
147985,
147986,
147987,
147988,
147989,
147990,
147991,
147992,
147993,
147994,
147995,
147996,
147997,
147998,
147999,
148000,
148001,
148002,
148003,
148004,
148005,
148006,
148007,
148008,
148009,
148010,
148011,
148012,
148013,
148014,
148015,
148016,
148017,
148018,
148019,
148020,
148021,
148022,
148023,
148024,
148025,
148026,
148027,
148028,
148029,
148030,
148031,
148032,
148033,
148034,
148035,
148036,
148037,
148038,
148039,
148040,
148041,
148042,
148043,
148044,
148045,
148046,
148047,
148048,
148049,
148050,
148051,
148052,
148053,
148054,
148055,
148056,
148057,
148058,
148059,
148060,
148061,
148062,
148063,
148064,
148065,
148066,
148067,
148068,
148069,
148070,
148071,
148072,
148073,
148074,
148075,
148076,
148077,
148078,
148079,
148080,
148081,
148082,
148083,
148084,
148085,
148086,
148087,
148088,
148089,
148090,
148091,
148092,
148093,
148094,
148095,
148096,
148097,
148098,
148099,
148100,
148101,
148102,
148103,
148104,
148105,
148106,
148107,
148108,
148109,
148110,
148111,
148112,
148113,
148114,
148115,
148116,
148117,
148118,
148119,
148120,
148121,
148122,
148123,
148124,
148125,
148126,
148127,
148128,
148129,
148130,
148131,
148132,
148133,
148134,
148135,
148136,
148137,
148138,
148139,
148140,
148141,
148142,
148143,
148144,
148145,
148146,
148147,
148148,
148149,
148150,
148151,
148152,
148153,
148154,
148155,
148156,
148157,
148158,
148159,
148160,
148161,
148162,
148163,
148164,
148165,
148166,
148167,
148168,
148169,
148170,
148171,
148172,
148173,
148174,
148175,
148176,
148177,
148178,
148179,
148180,
148181,
148182,
148183,
148184,
148185,
148186,
148187,
148188,
148189,
148190,
148191,
148192,
148193,
148194,
148195,
148196,
148197,
148198,
148199,
148200,
148201,
148202,
148203,
148204,
148205,
148206,
148207,
148208,
148209,
148210,
148211,
148212,
148213,
148214,
148215,
148216,
148217,
148218,
148219,
148220,
148221,
148222,
148223,
148224,
148225,
148226,
148227,
148228,
148229,
148230,
148231,
148232,
148233,
148234,
148235,
148236,
148237,
148238,
148239,
148240,
148241,
148242,
148243,
148244,
148245,
148246,
148247,
148248,
148249,
148250,
148251,
148252,
148253,
148254,
148255,
148256,
148257,
148258,
148259,
148260,
148261,
148262,
148263,
148264,
148265,
148266,
148267,
148268,
148269,
148270,
148271,
148272,
148273,
148274,
148275,
148276,
148277,
148278,
148279,
148280,
148281,
148282,
148283,
148284,
148285,
148286,
148287,
148288,
148289,
148290,
148291,
148292,
148293,
148294,
148295,
148296,
148297,
148298,
148299,
148300,
148301,
148302,
148303,
148304,
148305,
148306,
148307,
148308,
148309,
148310,
148311,
148312,
148313,
148314,
148315,
148316,
148317,
148318,
148319,
148320,
148321,
148322,
148323,
148324,
148325,
148326,
148327,
148328,
148329,
148330,
148331,
148332,
148333,
148334,
148335,
148336,
148337,
148338,
148339,
148340,
148341,
148342,
148343,
148344,
148345,
148346,
148347,
148348,
148349,
148350,
148351,
148352,
148353,
148354,
148355,
148356,
148357,
148358,
148359,
148360,
148361,
148362,
148363,
148364,
148365,
148366,
148367,
148368,
148369,
148370,
148371,
148372,
148373,
148374,
148375,
148376,
148377,
148378,
148379,
148380,
148381,
148382,
148383,
148384,
148385,
148386,
148387,
148388,
148389,
148390,
148391,
148392,
148393,
148394,
148395,
148396,
148397,
148398,
148399,
148400,
148401,
148402,
148403,
148404,
148405,
148406,
148407,
148408,
148409,
148410,
148411,
148412,
148413,
148414,
148415,
148416,
148417,
148418,
148419,
148420,
148421,
148422,
148423,
148424,
148425,
148426,
148427,
148428,
148429,
148430,
148431,
148432,
148433,
148434,
148435,
148436,
148437,
148438,
148439,
148440,
148441,
148442,
148443,
148444,
148445,
148446,
148447,
148448,
148449,
148450,
148451,
148452,
148453,
148454,
148455,
148456,
148457,
148458,
148459,
148460,
148461,
148462,
148463,
148464,
148465,
148466,
148467,
148468,
148469,
148470,
148471,
148472,
148473,
148474,
148475,
148476,
148477,
148478,
148479,
148480,
148481,
148482,
148483,
148484,
148485,
148486,
148487,
148488,
148489,
148490,
148491,
148492,
148493,
148494,
148495,
148496,
148497,
148498,
148499,
148500,
148501,
148502,
148503,
148504,
148505,
148506,
148507,
148508,
148509,
148510,
148511,
148512,
148513,
148514,
148515,
148516,
148517,
148518,
148519,
148520,
148521,
148522,
148523,
148524,
148525,
148526,
148527,
148528,
148529,
148530,
148531,
148532,
148533,
148534,
148535,
148536,
148537,
148538,
148539,
148540,
148541,
148542,
148543,
148544,
148545,
148546,
148547,
148548,
148549,
148550,
148551,
148552,
148553,
148554,
148555,
148556,
148557,
148558,
148559,
148560,
148561,
148562,
148563,
148564,
148565,
148566,
148567,
148568,
148569,
148570,
148571,
148572,
148573,
148574,
148575,
148576,
148577,
148578,
148579,
148580,
148581,
148582,
148583,
148584,
148585,
148586,
148587,
148588,
148589,
148590,
148591,
148592,
148593,
148594,
148595,
148596,
148597,
148598,
148599,
148600,
148601,
148602,
148603,
148604,
148605,
148606,
148607,
148608,
148609,
148610,
148611,
148612,
148613,
148614,
148615,
148616,
148617,
148618,
148619,
148620,
148621,
148622,
148623,
148624,
148625,
148626,
148627,
148628,
148629,
148630,
148631,
148632,
148633,
148634,
148635,
148636,
148637,
148638,
148639,
148640,
148641,
148642,
148643,
148644,
148645,
148646,
148647,
148648,
148649,
148650,
148651,
148652,
148653,
148654,
148655,
148656,
148657,
148658,
148659,
148660,
148661,
148662,
148663,
148664,
148665,
148666,
148667,
148668,
148669,
148670,
148671,
148672,
148673,
148674,
148675,
148676,
148677,
148678,
148679,
148680,
148681,
148682,
148683,
148684,
148685,
148686,
148687,
148688,
148689,
148690,
148691,
148692,
148693,
148694,
148695,
148696,
148697,
148698,
148699,
148700,
148701,
148702,
148703,
148704,
148705,
148706,
148707,
148708,
148709,
148710,
148711,
148712,
148713,
148714,
148715,
148716,
148717,
148718,
148719,
148720,
148721,
148722,
148723,
148724,
148725,
148726,
148727,
148728,
148729,
148730,
148731,
148732,
148733,
148734,
148735,
148736,
148737,
148738,
148739,
148740,
148741,
148742,
148743,
148744,
148745,
148746,
148747,
148748,
148749,
148750,
148751,
148752,
148753,
148754,
148755,
148756,
148757,
148758,
148759,
148760,
148761,
148762,
148763,
148764,
148765,
148766,
148767,
148768,
148769,
148770,
148771,
148772,
148773,
148774,
148775,
148776,
148777,
148778,
148779,
148780,
148781,
148782,
148783,
148784,
148785,
148786,
148787,
148788,
148789,
148790,
148791,
148792,
148793,
148794,
148795,
148796,
148797,
148798,
148799,
148800,
148801,
148802,
148803,
148804,
148805,
148806,
148807,
148808,
148809,
148810,
148811,
148812,
148813,
148814,
148815,
148816,
148817,
148818,
148819,
148820,
148821,
148822,
148823,
148824,
148825,
148826,
148827,
148828,
148829,
148830,
148831,
148832,
148833,
148834,
148835,
148836,
148837,
148838,
148839,
148840,
148841,
148842,
148843,
148844,
148845,
148846,
148847,
148848,
148849,
148850,
148851,
148852,
148853,
148854,
148855,
148856,
148857,
148858,
148859,
148860,
148861,
148862,
148863,
148864,
148865,
148866,
148867,
148868,
148869,
148870,
148871,
148872,
148873,
148874,
148875,
148876,
148877,
148878,
148879,
148880,
148881,
148882,
148883,
148884,
148885,
148886,
148887,
148888,
148889,
148890,
148891,
148892,
148893,
148894,
148895,
148896,
148897,
148898,
148899,
148900,
148901,
148902,
148903,
148904,
148905,
148906,
148907,
148908,
148909,
148910,
148911,
148912,
148913,
148914,
148915,
148916,
148917,
148918,
148919,
148920,
148921,
148922,
148923,
148924,
148925,
148926,
148927,
148928,
148929,
148930,
148931,
148932,
148933,
148934,
148935,
148936,
148937,
148938,
148939,
148940,
148941,
148942,
148943,
148944,
148945,
148946,
148947,
148948,
148949,
148950,
148951,
148952,
148953,
148954,
148955,
148956,
148957,
148958,
148959,
148960,
148961,
148962,
148963,
148964,
148965,
148966,
148967,
148968,
148969,
148970,
148971,
148972,
148973,
148974,
148975,
148976,
148977,
148978,
148979,
148980,
148981,
148982,
148983,
148984,
148985,
148986,
148987,
148988,
148989,
148990,
148991,
148992,
148993,
148994,
148995,
148996,
148997,
148998,
148999,
149000,
149001,
149002,
149003,
149004,
149005,
149006,
149007,
149008,
149009,
149010,
149011,
149012,
149013,
149014,
149015,
149016,
149017,
149018,
149019,
149020,
149021,
149022,
149023,
149024,
149025,
149026,
149027,
149028,
149029,
149030,
149031,
149032,
149033,
149034,
149035,
149036,
149037,
149038,
149039,
149040,
149041,
149042,
149043,
149044,
149045,
149046,
149047,
149048,
149049,
149050,
149051,
149052,
149053,
149054,
149055,
149056,
149057,
149058,
149059,
149060,
149061,
149062,
149063,
149064,
149065,
149066,
149067,
149068,
149069,
149070,
149071,
149072,
149073,
149074,
149075,
149076,
149077,
149078,
149079,
149080,
149081,
149082,
149083,
149084,
149085,
149086,
149087,
149088,
149089,
149090,
149091,
149092,
149093,
149094,
149095,
149096,
149097,
149098,
149099,
149100,
149101,
149102,
149103,
149104,
149105,
149106,
149107,
149108,
149109,
149110,
149111,
149112,
149113,
149114,
149115,
149116,
149117,
149118,
149119,
149120,
149121,
149122,
149123,
149124,
149125,
149126,
149127,
149128,
149129,
149130,
149131,
149132,
149133,
149134,
149135,
149136,
149137,
149138,
149139,
149140,
149141,
149142,
149143,
149144,
149145,
149146,
149147,
149148,
149149,
149150,
149151,
149152,
149153,
149154,
149155,
149156,
149157,
149158,
149159,
149160,
149161,
149162,
149163,
149164,
149165,
149166,
149167,
149168,
149169,
149170,
149171,
149763,
149782,
149783,
149784,
149785,
149786,
149787,
149788,
149789,
149790,
149791,
149792,
149793,
149794,
149795,
149797,
149798,
149799,
149800,
149801,
149802,
149803,
149804,
149805,
149806,
149807,
149808,
149809,
149810,
149811,
149812,
149813,
149814,
149815,
149816,
149817,
149818,
149819,
149820,
149821,
149822,
149823,
149824,
149825,
149826,
149827,
149828,
149829,
149830,
149831,
149832,
149833,
149834,
149835,
149836,
149837,
149838,
149839,
149840,
149841,
149842,
149843,
149844,
149845,
149846,
149847,
149848,
149849,
149850,
149851,
149852,
149853,
149854,
149855,
149856,
149857,
149858,
149859,
149860,
149861,
149862,
149863,
149864,
149865,
149866,
149867,
149868,
149869,
149870,
149871,
149872,
149873,
149874,
149875,
149876,
149877,
149878,
149879,
149880,
149881,
149882,
149883,
149884,
149885,
149886,
149887,
149888,
149889,
149890,
149891,
149893,
149894,
149895,
149896,
149897,
149898,
149899,
149900,
149901,
149902,
149903,
149904,
149905,
149906,
149907,
149908,
149909,
149910,
157454,
167092,
167093
]
    # list = [139282]
    for item in list:
        expression = "FID = " + str(item)
        startDataset = timeit.default_timer()
        arcpy.AddMessage('-------------------------------------------------------------------------------------------------')
        rows = arcpy.da.SearchCursor(DQQQ_ALL_FC,["FID", 'TABLE','SHAPE@'],expression)
        i=0
        for row in rows:
            arcpy.AddMessage('Start FID: ' + str(row[0]) + ' - processing Dataset: ' + row[1])
            tabfile_org = row[1].replace('nas2520','cabcvan1nas003')
            tabfile_path = ''
            tab_file_name = os.path.basename(tabfile_org)
            tab_file_org_path = os.path.dirname(tabfile_org)
            if os.path.exists(tabfile_org) > 0:
                tabfile_path = tab_file_org_path
            else:
                tabfile_path = find_file(tab_file_org_path, tab_file_name)
            if os.path.exists(tabfile_path):
                tab_file = os.path.join(tabfile_path, tab_file_name)
                img_path_info = get_ImagePathandExt(tab_file)
                if len(img_path_info[0]) > 0:
                    if img_path_info[1].lower() in ['.tif','.jpg','.sid','.png','.tiff','.jpeg','.jp2','.ecw']:
                        metaData = get_Image_Metadata(img_path_info[0],img_path_info[1],row[0])
                        # footprint_Polygon = get_Footprint(image_Path)
                        footprint_Polygon = row[2].projectAs(srWGS84)
                        UpdateSeamlessFC(DQQQ_footprint_FC,metaData,footprint_Polygon)
                    else:
                        arcpy.AddWarning("FID : {} - Input raster: is not the type of Composite Geodataset, or does not exist".format(row[0]))
                        logger.warning("FID :, {}, Input raster: is not the type of Composite Geodataset, or does not exist:, {} ".format(row[0], row[1]))
                else:
                    arcpy.AddWarning("FID :  {} -  Images is not available forthis path : {} ".format(row[0], row[1]))
                    logger.warning("FID : , {}, Images is not available for this path :, {} ".format(row[0], row[1]))
            else:
                arcpy.AddWarning("FID : {} - Tab file Path is not valid or available for: ".format(row[0]))
                logger.warning("FID : , {}, Tab file Path is not valid or available for:, {} ".format(row[0], row[1]))

    endTotal= timeit.default_timer()
    arcpy.AddMessage(('Total Duration:', round(endTotal -startTotal,4)))


